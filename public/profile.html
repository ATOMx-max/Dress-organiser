<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Profile | Dress Organizer</title>

  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />

<style>
:root{
  --bg1:#1e1b4b; --bg2:#312e81; --bg3:#4c1d95;
  --muted: rgba(255,255,255,0.12);
  --card-bg: rgba(255,255,255,0.08);
  --glass-border: rgba(255,255,255,0.15);
  --accent: #6366f1;
  --success: #4ade80;
  --danger: #f87171;
  --toast-z: 99999;
  --sidebar-w: 260px;
}

*{box-sizing:border-box;margin:0;padding:0}
html,body{height:100%}
body{
  font-family:"Inter",sans-serif;
  background: linear-gradient(135deg,var(--bg1),var(--bg2),var(--bg3));
  color:white;
  min-height:100vh;
  overflow:hidden;
}

/* APP WRAPPER */
.app {
  display:flex;
  height:100vh;
  width:100%;
  position:relative;
}

/* SIDEBAR (Mobile Only) */
.sidebar {
  width:var(--sidebar-w);
  background: rgba(255,255,255,0.06);
  border-right:1px solid var(--glass-border);
  padding:22px;
  display:none;                 /* ‚ú® HIDDEN ON DESKTOP */
  flex-direction:column;
  transform: translateX(calc(-1 * (var(--sidebar-w) + 14px)));
  transition: transform .38s;
  z-index:30;
  backdrop-filter: blur(8px);
  box-shadow: 0 8px 30px rgba(0,0,0,0.4);
}
.sidebar.open { transform:translateX(0); }

/* Sidebar content */
.logo { font-size:1.25rem; font-weight:700; margin-bottom:18px; display:flex; align-items:center; gap:10px; }
.logo .brand-icon { width:36px; height:36px; border-radius:8px; display:flex; align-items:center; justify-content:center; background:linear-gradient(135deg,#818cf8,#c084fc); }

.nav-list { display:flex; flex-direction:column; gap:8px; margin-top:8px; }
.nav-item {
  display:flex; align-items:center; gap:12px; padding:10px 12px; border-radius:10px; cursor:pointer;
  transition: all .18s ease; color: #fff; font-weight:500;
}
.nav-item:hover { background: rgba(255,255,255,0.06); transform: translateX(6px); }
.nav-item.active { background: rgba(255,255,255,0.12); font-weight:700; }
.nav-item .icon { font-size:1.15rem; width:22px; }

/* MAIN CONTENT */
.main {
  flex:1;
  overflow-y:auto;
  padding:28px 28px 120px 28px;
  position:relative;
}

/* TOPBAR */
.topbar {
  display:flex; align-items:center; justify-content:space-between; gap:12px; margin-bottom:18px;
}
.sidebar-toggle {
  width:44px;height:44px;border-radius:10px;
  background:rgba(255,255,255,0.06);
  border:1px solid rgba(255,255,255,0.06);
  display:none;                        /* ‚ú® HIDDEN ON DESKTOP */
  align-items:center; justify-content:center;
  font-size:18px; cursor:pointer;
}
.page-title {
  font-size:1.4rem; font-weight:700;
  background:linear-gradient(135deg,#fff,#e0e7ff);
  -webkit-background-clip:text; -webkit-text-fill-color:transparent;
}

/* CARDS */
.card {
  background: rgba(255,255,255,0.06);
  border: 1px solid rgba(255,255,255,0.12);
  padding:18px;
  margin-bottom:18px;
  border-radius:12px;
  backdrop-filter: blur(8px);
}

/* PROFILE AREA */
.profile-area { display:flex; gap:18px; align-items:center; flex-wrap:wrap; }
.profile-pic { width:110px; height:110px; border-radius:50%; object-fit:cover; }

/* BUTTONS */
.action-btn { padding:10px 16px; border-radius:12px; background: rgba(255,255,255,0.08); border:1px solid rgba(255,255,255,0.12); cursor:pointer; }

/* MOBILE NAV */
.bottom-nav {
  display:none;
  position:fixed;
  left:50%; transform:translateX(-50%);
  bottom:12px;
  width:calc(100% - 28px);
  max-width:720px;
  background:rgba(255,255,255,0.04);
  border-radius:14px;
  padding:8px;
  justify-content:space-around;
  border:1px solid rgba(255,255,255,0.06);
  backdrop-filter:blur(8px);
}
.bottom-btn { flex:1; padding:10px 8px; text-align:center; cursor:pointer; }

/* MOBILE RULES */
@media (max-width:720px){
  .sidebar { display:flex; }        /* Sidebar mobile only */
  .sidebar-toggle { display:flex; } /* Toggle button mobile only */
  .bottom-nav { display:flex; }
}

/* DESKTOP RULES */
@media (min-width:721px){
  .sidebar { display:none !important; }
  .sidebar-toggle { display:none !important; }
}
</style>
</head>

<body>

<div class="app">

  <!-- MOBILE SIDEBAR -->
  <aside id="sidebar" class="sidebar" aria-hidden="true">
    <div class="logo">
      <div class="brand-icon">üëó</div>
      <div>
        <div style="font-weight:700">Dress Organizer</div>
        <div style="font-size:12px;opacity:.8">My Wardrobe</div>
      </div>
    </div>

    <nav class="nav-list">
      <div class="nav-item" onclick="location.href='dashboard.html'"><span class="icon">üè†</span>Dashboard</div>
      <div class="nav-item" onclick="location.href='all-dresses.html'"><span class="icon">üëó</span>All Dresses</div>
      <div class="nav-item" onclick="location.href='upload.html'"><span class="icon">‚¨ÜÔ∏è</span>Upload</div>
      <div class="nav-item" onclick="location.href='manage.html'"><span class="icon">üìÇ</span>Manage</div>
      <div class="nav-item" onclick="location.href='search.html'"><span class="icon">üîç</span>Search</div>
      <div class="nav-item" onclick="location.href='favourites.html'"><span class="icon">‚ù§Ô∏è</span>Favourites</div>
      <div class="nav-item active"><span class="icon">‚öôÔ∏è</span>Profile</div>
      <div style="flex:1"></div>
      <div class="nav-item" onclick="logout()"><span class="icon">üö™</span>Logout</div>
    </nav>
  </aside>

  <!-- MAIN -->
  <main id="main" class="main">

    <div class="topbar">
      <div style="display:flex;gap:12px;align-items:center;">
        <button id="sidebarToggle" class="sidebar-toggle">‚ò∞</button>
        <div>
          <div class="page-title">Your Profile</div>
          <div style="opacity:.7;font-size:.9rem;">Manage account & settings</div>
        </div>
      </div>

      <div style="display:flex;gap:10px;">
        <button class="action-btn" onclick="openPasswordModal()">üîê Change Password</button>
        <button class="action-btn" style="background:rgba(255,70,70,0.15);" onclick="openDeleteModal()">üóë Delete</button>
      </div>
    </div>

    <!-- Profile Card -->
    <section class="card">
      <div class="profile-area">
        <div style="display:flex;flex-direction:column;align-items:center;">
          <img id="profilePic" src="default.jpg" class="profile-pic" />
          <label class="action-btn" style="margin-top:10px;">
            Upload New Photo
            <input type="file" id="picInput" hidden accept="image/*">
          </label>
        </div>

        <div style="flex:1;min-width:200px;">
          <div style="display:flex;justify-content:space-between;">
            <div>
              <div id="name" style="font-size:1.2rem;font-weight:800;">‚Äî</div>
              <div id="email" style="opacity:.7;">‚Äî</div>
            </div>
            <button class="action-btn" onclick="editName()">Edit Name</button>
          </div>

          <div style="margin-top:12px;display:flex;gap:10px;">
            <button class="action-btn" onclick="location.href='manage.html'">‚öôÔ∏è Manage</button>
            <button class="action-btn" onclick="location.href='upload.html'">üì§ Upload</button>
            <button class="action-btn" onclick="location.href='favourites.html'">‚≠ê Favourites</button>
          </div>
        </div>
      </div>
    </section>

    <!-- Info Card -->
    <section class="card">
      <div style="display:flex;justify-content:space-between;padding:12px 0;border-bottom:1px solid rgba(255,255,255,0.1);">
        <span>Username</span>
        <span id="username">‚Äî</span>
      </div>

      <div style="display:flex;justify-content:space-between;padding:12px 0;border-bottom:1px solid rgba(255,255,255,0.1);">
        <span>Status</span>
        <span id="verifyBadge2">‚Äî</span>
      </div>

      <div style="display:flex;justify-content:space-between;padding:12px 0;">
        <span>Joined</span>
        <span id="joined">‚Äî</span>
      </div>
    </section>

  </main>
</div>

<!-- MOBILE NAV -->
<div class="bottom-nav">
  <div class="bottom-btn" onclick="location.href='dashboard.html'">üè†</div>
  <div class="bottom-btn" onclick="location.href='upload.html'">üì§</div>
  <div class="bottom-btn" onclick="location.href='search.html'">üîç</div>
  <div class="bottom-btn" onclick="location.href='favourites.html'">‚≠ê</div>
  <div class="bottom-btn" onclick="toggleSidebar()">‚ò∞</div>
</div>

<script>
const sidebarEl = document.getElementById("sidebar");
const mainEl = document.getElementById("main");
const sidebarToggleBtn = document.getElementById("sidebarToggle");

/* SIDEBAR TOGGLE */
function toggleSidebar(){
  if(sidebarEl.classList.contains("open")){
    sidebarEl.classList.remove("open");
  } else {
    sidebarEl.classList.add("open");
  }
}

/* CLOSE SIDEBAR WHEN CLICKING OUTSIDE (MOBILE ONLY) */
document.addEventListener("click", (e)=>{
  if(window.innerWidth <= 720){
    if(!sidebarEl.contains(e.target) && !sidebarToggleBtn.contains(e.target)){
      sidebarEl.classList.remove("open");
    }
  }
});

/* LOAD USER INFO */
async function loadUser(){
  const API_URL = window.location.origin;
  try{
    const r = await fetch(`${API_URL}/api/me`, {credentials:"include"});
    if(!r.ok) return location.href="login.html";

    const u = await r.json();
    document.getElementById("name").textContent = u.name;
    document.getElementById("email").textContent = u.email;
    document.getElementById("username").textContent = u.username || "‚Äî";
    document.getElementById("joined").textContent = new Date(u.joined).toLocaleDateString();
    document.getElementById("profilePic").src = u.profilePic || "default.jpg";

    document.getElementById("verifyBadge2").textContent = u.verified ? "Verified" : "Not Verified";

  } catch(e){
    console.log(e);
  }
}

loadUser();
</script>

</body>
</html>
