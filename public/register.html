<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Register | Dress Organizer</title>

  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />

  <style>
    *{margin:0;padding:0;box-sizing:border-box;}

    :root{
      --bg1:#1e1b4b;
      --bg2:#312e81;
      --bg3:#4c1d95;
      --accent1:#818cf8;
      --accent2:#c084fc;
      --muted:#c7d2fe;
    }

    body{
      font-family:"Inter",sans-serif;
      background:linear-gradient(135deg,var(--bg1),var(--bg2),var(--bg3));
      height:100vh;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:24px;
      color:white;
      position:relative;
      overflow:hidden;
    }

    /* Floating Orbs */
    .orb{
      position:absolute;
      border-radius:50%;
      filter:blur(90px);
      opacity:0.18;
      animation:float 20s infinite ease-in-out;
      z-index:0;
    }
    .orb-1{width:500px;height:500px;top:-180px;left:-160px;background:linear-gradient(135deg,#818cf8,#c084fc);}
    .orb-2{width:400px;height:400px;bottom:-160px;right:-140px;background:linear-gradient(135deg,#f472b6,#fb923c);animation-delay:4s;}
    .orb-3{width:360px;height:360px;top:40%;left:50%;transform:translate(-50%, -50%);background:linear-gradient(135deg,#06b6d4,#3b82f6);animation-delay:8s;}

    @keyframes float{
      0%,100%{transform:translate(0,0) scale(1);}
      40%{transform:translate(40px,-40px) scale(1.1);}
      70%{transform:translate(-30px,30px) scale(.9);}
    }

    /* Main Card */
    .card{
      width:100%;
      max-width:460px;
      padding:35px;
      border-radius:26px;
      backdrop-filter:blur(22px);
      background:rgba(255,255,255,0.06);
      border:1px solid rgba(255,255,255,0.14);
      box-shadow:0 20px 60px rgba(0,0,0,0.45);
      z-index:10;
      text-align:center;
      animation:popIn .65s cubic-bezier(0.16,1,0.3,1);
    }

    @keyframes popIn{
      from{opacity:0;transform:translateY(30px) scale(.96);}
      to{opacity:1;transform:translateY(0) scale(1);}
    }

    /* Logo */
    .logo{
      width:80px;height:80px;
      display:flex;justify-content:center;align-items:center;
      font-size:38px;
      background:linear-gradient(135deg,#818cf8,#c084fc);
      margin:0 auto 18px;
      border-radius:20px;
      box-shadow:0 10px 30px rgba(129,140,248,0.2);
      animation:floatLogo 3s infinite ease-in-out;
    }

    @keyframes floatLogo{
      0%,100%{transform:translateY(0);}
      50%{transform:translateY(-10px);}
    }

    /* Inputs */
    .input-group{margin-bottom:18px;}

    input{
      width:100%;
      padding:14px 16px;
      background:rgba(0,0,0,0.35);
      border:1px solid rgba(255,255,255,0.18);
      border-radius:12px;
      color:white;
      font-size:15px;
      outline:none;
      transition:.25s;
    }

    input:focus{
      border-color:var(--accent2);
      box-shadow:0 0 0 6px rgba(192,132,252,0.25);
      transform:translateY(-2px);
    }

    .toggle{
      position:absolute;right:12px;top:50%;transform:translateY(-50%);
      cursor:pointer;font-size:18px;color:rgba(255,255,255,0.8);
    }

    /* Submit Button */
    button{
      width:100%;
      padding:14px;
      border:none;
      border-radius:12px;
      margin-top:10px;
      font-size:15px;
      font-weight:700;
      background:linear-gradient(135deg,var(--accent1),var(--accent2));
      color:white;
      cursor:pointer;
      transition:.2s;
      box-shadow:0 10px 26px rgba(129,140,248,0.3);
    }
    button:hover{transform:translateY(-3px);}

    .spinner{
      width:18px;height:18px;border:3px solid rgba(255,255,255,0.4);
      border-top-color:transparent;border-radius:50%;
      display:none;
      animation:spin .7s linear infinite;
    }
    @keyframes spin{to{transform:rotate(360deg);}}

    /* Message Box */
    .msg{
      margin-top:16px;
      padding:12px;
      border-radius:10px;
      font-weight:600;
      display:none;
    }

    .msg.show{display:block;}
    .msg.error{background:#fee2e2;color:#991b1b;}
    .msg.info{background:#e0e7ff;color:#1e3a8a;}
    .msg.success{background:#dcfce7;color:#166534;}

    .links a{
      color:var(--muted);
      text-decoration:none;
      font-weight:600;
      display:inline-block;
      margin-top:14px;
    }
    .links a:hover{color:var(--accent2);}
  </style>
</head>

<body>

  <!-- Background Orbs -->
  <div class="orb orb-1"></div>
  <div class="orb orb-2"></div>
  <div class="orb orb-3"></div>

  <div class="card">
    <div class="logo">üëó</div>

    <h2 style="margin-bottom:8px;">Create Account</h2>
    <p style="color:var(--muted);margin-bottom:20px;">Start organizing your wardrobe</p>

    <form id="registerForm" novalidate>

      <div class="input-group">
        <input id="name" type="text" placeholder="Full Name" autocomplete="name" />
      </div>

      <div class="input-group">
        <input id="username" type="text" placeholder="Username (optional)" autocomplete="username" />
      </div>

      <div class="input-group">
        <input id="email" type="email" placeholder="Email Address" required />
      </div>

      <div class="input-group" style="position:relative;">
        <input id="password" type="password" placeholder="Password" required />
        <span class="toggle" data-target="password">üëÅÔ∏è</span>
      </div>

      <div class="input-group" style="position:relative;">
        <input id="confirmPassword" type="password" placeholder="Confirm Password" required />
        <span class="toggle" data-target="confirmPassword">üëÅÔ∏è</span>
      </div>

      <button type="submit" id="registerBtn">
        <span class="btn-text">Create Account</span>
        <span class="spinner"></span>
      </button>
    </form>

    <p id="msg" class="msg"></p>

    <div class="links">
      <a href="login.html">Already have an account? Login</a>
    </div>
  </div>

<script>
const API_URL = window.location.origin.includes("localhost")
  ? "http://localhost:8080"
  : "https://dress-organiser.onrender.com";

document.querySelectorAll(".toggle").forEach(icon => {
  icon.addEventListener("click", () => {
    const input = document.getElementById(icon.dataset.target);
    input.type = input.type === "password" ? "text" : "password";
    icon.textContent = input.type === "password" ? "üëÅÔ∏è" : "üôà";
  });
});

const form = document.getElementById("registerForm");
const msg = document.getElementById("msg");
const registerBtn = document.getElementById("registerBtn");
const spinner = registerBtn.querySelector(".spinner");
const btnText = registerBtn.querySelector(".btn-text");

form.addEventListener("submit", async (e) => {
  e.preventDefault();

  const name = document.getElementById("name").value.trim();
  const username = document.getElementById("username").value.trim();
  const email = document.getElementById("email").value.trim();
  const password = document.getElementById("password").value.trim();
  const confirmPassword = document.getElementById("confirmPassword").value.trim();

  if (!/\S+@\S+\.\S+/.test(email)) {
    showMessage("‚ö† Enter a valid email address.", "error");
    return;
  }

  if (password !== confirmPassword) {
    showMessage("‚ö† Passwords do not match.", "error");
    return;
  }

  if (password.length < 6) {
    showMessage("‚ö† Password must be at least 6 characters long.", "error");
    return;
  }

  loading(true, "Creating your account...");

  try {
    const res = await fetch(`${API_URL}/register`, {
      method:"POST",
      headers:{ "Content-Type":"application/json" },
      body:JSON.stringify({ name, username, email, password })
    });

    const data = await res.json();

    if (!res.ok) {
      showMessage("‚ùå " + (data.message || "Registration failed."), "error");
      loading(false);
      return;
    }

    showMessage("‚úÖ Account created! Please verify your email.", "success");

  } catch (err) {
    showMessage("‚ö† Server error. Please try again.", "error");
  }

  loading(false);
});

function loading(isLoading, text="") {
  if (isLoading) {
    msg.className = "msg info show";
    msg.textContent = text;
    spinner.style.display = "inline-block";
    btnText.style.display = "none";
    registerBtn.disabled = true;
  } else {
    spinner.style.display = "none";
    btnText.style.display = "inline";
    registerBtn.disabled = false;
  }
}

function showMessage(text, type="info") {
  msg.textContent = text;
  msg.className = `msg ${type} show`;
}
</script>

</body>
</html>
